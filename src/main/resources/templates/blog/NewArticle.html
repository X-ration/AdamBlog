<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default">
<head>
    <meta charset="UTF-8"/>
    <title>New Article</title>
</head>
<body>

<div layout:fragment="content">
    <div class="row">
        <nav>
            <div class="nav-wrapper container">
                <div class="col s12">
                    <a href="/" class="breadcrumb">Index</a>
                    <a href="/mood/" class="breadcrumb">Blog</a>
                    <a class="breadcrumb">New Article</a>
                </div>
            </div>
        </nav>
    </div>
    <div class="container">
        <form action="/blog/newarticle" method="post">
            <!-- Key content -->
            <h4>Publish article</h4>
            <!-- Author -->
            <div class="row">
                <div class="input-field col s12 m6">
                    <i class="material-icons prefix">person</i>
                    <input th:field="${article.author}" id="author" type="text" required="required"/>
                    <label for="author">Author</label>
                </div>
            </div>
            <!-- Title -->
            <div class="row">
                <div class="input-field col s12 m6">
                    <i class="material-icons prefix">person</i>
                    <input th:field="${article.title}" id="title" type="text" required="required"/>
                    <label for="title">Title</label>
                </div>
            </div>
            <!-- Content Paragraphs -->
            <div id="paragraphs">
                <div class="row">
                    <div class="input-field col s10">
                        <i class="material-icons prefix">mode_edit</i>
                        <textarea th:field="${article.contentParagraphs[0]}" id="contentParagraph0" required="required" class="materialize-textarea"></textarea>
                        <label for="contentParagraph0">Article paragraph 0</label>
                    </div>
                    <div id="addParagraphButton" class="col s2">
                        <a onclick="addParagraph()" style="cursor: pointer;">
                            <i class="material-icons medium teal-text">add_circle</i>
                        </a>
                    </div>
                </div>
            </div>
            <button id="submitArticle" type="submit" name="submitArticle"
                    class="btn waves-effect waves-light">Publish article</button>

        </form>
    </div>
</div>

<script layout:fragment="script">
    var currentLocation = 0;
    function addParagraph() {
        currentLocation += 1;
        $("#addParagraphButton").remove();

        var $row = $("<div></div>");
        $row.attr("class","row");
        var $inputField = $("<div></div>");
        $inputField.attr("class","input-field col s10");
        var $editI = $("<i>mode_edit</i>");
        $editI.attr("class","material-icons prefix");
        var $textArea = $("<textarea></textarea>");
        $textArea.attr("name","contentParagraphs["+currentLocation+"]");
        //$textArea.attr("placeholder","Edit this paragraph...");
        $textArea.attr("id","contentParagraph"+currentLocation);
        $textArea.attr("required","required");
        $textArea.attr("class","materialize-textarea");
        var $textAreaLabel = $("<label>Article paragraph "+currentLocation+"</label>");
        $textAreaLabel.attr("for","contentParagraph"+currentLocation);
        $inputField.append($editI);
        $inputField.append($textArea);
        $inputField.append($textAreaLabel);
        $row.append($inputField);

        var $addButtonDiv = $("<div></div>");
        $addButtonDiv.attr("id","addParagraphButton");
        $addButtonDiv.attr("class","col s2");
        var $buttonA = $("<a></a>");
        $buttonA.attr("onclick","addParagraph()");
        $buttonA.attr("style","cursor: pointer;");
        var $buttonI = $("<i>add_circle</i>");
        $buttonI.attr("class","material-icons medium teal-text");
        $buttonA.append($buttonI);
        $addButtonDiv.append($buttonA);
        $row.append($addButtonDiv);

        $("#paragraphs").append($row);
    }
</script>
</body>
</html>